1. The "New Project" Flow (Setting the Foundation)
This flow establishes the project and its planned revenue (budget).

Frontend (React):

User clicks "New Project" button.

React requests client list: GET /api/contacts?type=client to populate the "Client" dropdown.

User submits form. React sends payload to POST /api/projects:

JSON

{ "name": "Website Redesign", "client_id": 5, "manager_id": 2, "status": "planned" }
Backend (Node/Sequelize):

Validates data (ensures client ID 5 exists).

Creates a new record in the projects table.

Follow-up Action (The Budget):

PM immediately creates a Sales Order to define the budget.

React sends POST /api/sales-orders with project_id matched to the new project.

Backend inserts into sales_orders table. This is now your "Planned Revenue".

2. The "Execution & Cost" Flow (Money Out)
This flow is how work happens and costs accumulate against the project.

A. Internal Labor (Timesheets)
Frontend:

Team member clicks "Log Time" on a task.

React sends POST /api/timesheets:

JSON

{ "project_id": 10, "task_id": 50, "hours": 4, "user_id": 12 }
Backend:

Looks up the user's current hourly_rate from the users table (e.g., $50/hr).

Inserts record into timesheets table, freezing that rate: { ..., "hours": 4, "cost_rate": 50.00 }.

Why freeze it? If the user gets a raise later, old timesheets shouldn't change cost.

B. External Costs (Vendor Bills)
Frontend:

PM receives a bill from a freelancer. Inside the project Finance tab, they click "Add Vendor Bill".

React sends POST /api/vendor-bills with project_id and vendor_id (from contacts table).

Backend:

Inserts into vendor_bills table. The project's "Actual Cost" just increased.

3. The "Billing" Flow (Money In)
Realizing revenue by invoicing the client.

Frontend:

PM reviews project progress. Decides to bill for Milestone 1.

Clicks "Create Invoice". React knows the current project_id (e.g., 10) and associated client_id (e.g., 5).

User adds line items in UI. React sends POST /api/invoices.

Backend:

Inserts into invoices table linked to Project #10.

4. The "X-Factor" Flow (Real-Time Profit Ticker)
This is the critical loop that makes your app feel "alive" and integrated. Every time Flow 2 or 3 happens, this flow triggers.

Trigger: Frontend completes any POST/PUT/DELETE action on timesheets, bills, or invoices.

Action: React immediately re-fetches the project vitals: GET /api/projects/10/stats.

Backend Calculation Logic:

It runs a combined query (or several optimized ones) to get live totals:

TOTAL_REVENUE = Sum of total_amount from invoices where project_id = 10.

LABOR_COST = Sum of (hours * cost_rate) from timesheets where project_id = 10.

VENDOR_COST = Sum of total_amount from vendor_bills where project_id = 10.

PROFIT = TOTAL_REVENUE - (LABOR_COST + VENDOR_COST).

Frontend Update:

The ticker at the top of the dashboard updates instantly from Green (healthy margin) to Red (danger) if costs exceed revenue.